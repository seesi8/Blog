<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset='UTF-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Blog</title>


  <!--Owl-Carousel-->
  <link rel='stylesheet' href='/CSS/owl.carousel.min.css'>
  <link rel='stylesheet' href='/CSS/owl.theme.default.min.css'>
  <!-- Custom Style-->
  <link rel='stylesheet' href='/CSS/posts.css'>


  <!--AOS Lib-->
  <link rel='stylesheet' href='/CSS/aos.css'>

  <!--font awesome-->
  <link rel='stylesheet' href='/CSS/all.css'>
  <link rel='stylesheet' href='/CSS/nav.css'>

</head>

<body>

  <!--Nav-->
  <%- include('_nav') %>
    <!--Nav end-->

    <main>
      <div class='new-posts'>
        <div class='search-bar'>
          <form action=''>
            <div class='form-group'>
              <input value='' type='text' name='keywords' id='keywords' class='form-control text' placeholder='Search'>
            </div>
            <div class='form-group'>
              <button type='submit' class='Submit-btn btn'>Search</button>
            </div>
          </form>
        </div>
        <h1 class='new-posts-title'> New Posts </h1>
        <div class='foreacharticle'>
          <%- include('_articlesdate')%>
        </div>

        <div class='pagination flex-row'>
          <a href='/articles/posts/?page=<%=parseInt(page)-1%>'><i class='fas fa-chevron-left'></i></a>
          <a href='/articles/posts/?page=<%=parseInt(page)-1%>' class='pages pre-page'>
            <%=parseInt(page)-1%>
          </a>
          <a href='#' class='pages current-page'>
            <%=page%>
          </a>
          <a href='/articles/posts/?page=<%=parseInt(page)+1%>' class='pages post-page'>
            <%=parseInt(page)+1%>
          </a>
          <a href='/articles/posts/?page=<%=parseInt(page)+1%>'><i class='fas fa-chevron-right'></i></a>
        </div>
      </div>
      <aside class='sidebar'>
        <div class='category-list'>
          <h2>Category</h2>
          <!--style='width: <%=tags[2][1]*1%>rem; max-width: 20rem; min-width: 6rem;'*-->
          <li class='list-items' data-aos='fade-left' data-aos-delay='100'>
            <a href='/articles/tag/<%=tags[0][0]%>'>
              <%=tags[0][0]%>
            </a>
            <span>(<%=tags[0][1]%>)</span>
          </li>
          <li class='list-items' data-aos='fade-left' data-aos-delay='200'>
            <a href='/articles/tag/<%=tags[1][0]%>'>
              <%=tags[1][0]%>
            </a>
            <span>(<%=tags[1][1]%>)</span>
          </li>
          <li class='list-items' data-aos='fade-left' data-aos-delay='300'>
            <a href='/articles/tag/<%=tags[2][0]%>'>
              <%=tags[2][0]%>
            </a>
            <span>(<%=tags[2][1]%>)</span>
          </li>
          <li class='list-items' data-aos='fade-left' data-aos-delay='400'>
            <a href='/articles/tag/<%=tags[3][0]%>'>
              <%=tags[3][0]%>
            </a>
            <span>(<%=tags[3][1]%>)</span>
          </li>
          <li class='list-items' data-aos='fade-left' data-aos-delay='500'>
            <a href='/articles/tag/<%=tags[4][0]%>'>
              <%=tags[4][0]%>
            </a>
            <span>(<%=tags[4][1]%>)</span>
          </li>
        </div>
        <div class='popular-post'>
          <h2>Popular Post</h2>
          <% articlespop.forEach(article=> { %>
            <div class='post-content'>
              <div class='post-image'>
                <div>
                  <img src='/images/<%= article.multerphoto%>' class='img' alt='blog1'>
                </div>
                <div class='post-info flex-row'>
                  <span>
                    <i class='fas fa-calendar-alt text-gray'></i>
                    &nbsp;&nbsp; <%=article.createdAt.toLocaleDateString()%>
                  </span>
                  <span>
                    <i class='fa-solid fa-heart hide'></i>
                    &nbsp;&nbsp;<%= article.pop %>
                  </span>
                </div>
              </div>
              <div class='post-title'>
                <a href='#'>
                  <%= article.title %>
                </a>
              </div>
            </div>
            <% }) %>
        </div>
        <div class='newsletter'>

        </div>
        <div class='popular-tags' data-aos='fade-us' data-aos-delay='300'>
          <h2>Popular tags</h2>
          <div class="tags flex-row">
            <span class="tag" data-aos="flip-us" data-aos-delay="100"><a href="/articles/tag/<%=tags[0][0]%>"><%=tags[0][0]%></a></span>
            <span class="tag" data-aos="flip-us" data-aos-delay="200"><a href="/articles/tag/<%=tags[1][0]%>"><%=tags[1][0]%></a></span>
            <span class="tag" data-aos="flip-us" data-aos-delay="300"><a href="/articles/tag/<%=tags[2][0]%>"><%=tags[2][0]%></a></span>
            <span class="tag" data-aos="flip-us" data-aos-delay="400"><a href="/articles/tag/<%=tags[3][0]%>"><%=tags[3][0]%></a></span>
            <span class="tag" data-aos="flip-us" data-aos-delay="500"><a href="/articles/tag/<%=tags[4][0]%>"><%=tags[4][0]%></a></span>
            <span class="tag" data-aos="flip-us" data-aos-delay="600"><a href="/articles/tag/<%=tags[5][0]%>"><%=tags[5][0]%></a></span>
            <span class="tag" data-aos="flip-us" data-aos-delay="700"><a href="/articles/tag/<%=tags[6][0]%>"><%=tags[6][0]%></a></span>
            <span class="tag" data-aos="flip-us" data-aos-delay="800"><a href="/articles/tag/<%=tags[7][0]%>"><%=tags[7][0]%></a></span>
        </div>
        </div>
      </aside>
      <!--only used to show in js variable-->
      <div class="hide all-posts">
        <%- include('_articles')%>
      </div>
      <div class='hide date-posts'>
        <%- include('_articlesdate')%>
      </div>
    </main>
    <%- include('_footer')%>

</body>
<!-- Jquery Library File-->
<script src='/Js/Jquery_3.6.0.min.js'></script>

<!--Owl-Carousel-->
<script src='/Js/owl.carousel.min.js'></script>

<!--AOS Lib-->
<script src='/Js/aos.js'></script>

<!-- Custom Js-->
<script src='/Js/posts.js'></script>
<script>
  if (<%= page %> -1 <= 0) {
    $('.pre-page').toggleClass('hide')
    $('.fa-chevron-left').toggleClass('hide')
  }

  if (<%= page %> +1 > <%= max %>) {
    $('.post-page').toggleClass('hide')
    $('.fa-chevron-right').toggleClass('hide')
  }
  ; (function search() {
    ;[...document.querySelectorAll('.new-posts')].forEach(makeSearchable)
    function makeSearchable($searchable) {
      const $search = $searchable.querySelector('input')

      console.log($searchable)
      console.log($search)


      $search.addEventListener('keyup', (e) => {
        if ($('.form-group input').html()) {
          $('.foreacharticle').html($('.all-posts').html())
          $('.post-page').addClass('hide')
          $('.current-page').addClass('hide')
          $('.fa-chevron-right').addClass('hide')
          $('.pre-page').addClass('hide')
          $('.fa-chevron-left').addClass('hide')
        }
        if (!$('.form-group input').html()) {
          $('.foreacharticle').html($('.date-posts').html())
          $('.post-page').toggleClass('hide')
          $('.current-page').toggleClass('hide')
          $('.fa-chevron-right').toggleClass('hide')
          $('.pre-page').toggleClass('hide')
          $('.fa-chevron-left').toggleClass('hide')
          if (<%= page %> -1 <= 0) {
            $('.pre-page').toggleClass('hide')
            $('.fa-chevron-left').toggleClass('hide')
          }

          if (<%= page %> +1 > <%= max %>) {
            $('.post-page').toggleClass('hide')
            $('.fa-chevron-right').toggleClass('hide')
          }
        }
        const $searchableItems = [...$searchable.querySelectorAll('.card')]
        console.log($searchableItems)
        $searchableItems.forEach(function ($el) {
          console.log('here')
          const text = $el.getAttribute('data-search') || $el.innerText
          const show = new RegExp(e.target.value, 'i').test(text)
          $el.style.display = show ? '' : 'none'
        })
      })

    }
  })()
</script>

</html>